# Changelog

## [1.3.2] - 2024-02-16

### Added
- Добавлена полная поддержка GPU через NVIDIA Container Runtime в WSL2
- Реализована интеграция с deepseek-r1:14b моделью
- Добавлены оптимизации для GPU производительности
- Улучшена система мониторинга GPU ресурсов
- Добавлена автоматическая настройка CUDA окружения
- Реализован механизм конвергенции состояния
- Добавлена поддержка GitOps workflow
- Интеграция с container registry

### Changed
- Обновлены все компоненты для работы с CUDA 12.8
- Оптимизированы настройки GPU для LLM моделей
- Улучшена документация по GPU интеграции
- Обновлены параметры безопасности
- Оптимизирована структура проекта
- Улучшена система сборки с поддержкой GPU

### Security
- Усилена защита GPU ресурсов через RBAC
- Добавлены дополнительные проверки безопасности
- Улучшен аудит GPU операций
- Внедрена система лицензирования
- Улучшена безопасность доступа к GPU ресурсам

## [1.3.0] - 2024-02-15

### Added
- Интеграция с NVIDIA GPU в WSL2
- Автоматическая настройка CUDA окружения
- Система управления состоянием кластера
- Механизм конвергенции состояния
- Добавлена поддержка модели deepseek-r1:14b
- Оптимизация GPU параметров
- Улучшенный мониторинг
- Новые инструменты диагностики

### Changed
- Оптимизирована структура проекта
- Улучшена система сборки
- Обновлены конфигурации для GPU
- Расширена документация
- Обновлены компоненты безопасности
- Улучшена производительность GPU
- Оптимизирована память

### Fixed
- Исправлены проблемы с TLS сертификатами
- Улучшена работа с GPU в WSL2
- Оптимизирована производительность LLM
- Исправлены проблемы с DNS

## [1.3.1] Zakenak

### Changed
- Перемещены конфигурационные файлы для лучшей организации проекта:
  - Директория `manifests/` перенесена из `tools/k8s-kind-setup/` в `helm-charts/`
  - `kind-config.yaml` перемещен из `tools/k8s-kind-setup/` в корень `helm-charts/`
  - Обновлены все ссылки на манифесты в скриптах развертывания

### Removed
- Удален устаревший скрипт `setup-gpu.sh` (функциональность перенесена в Helm values)
- Удален устаревший скрипт `setup.sh` (заменен на `deploy-all.sh`)

### Added
- Добавлен новый скрипт `get-dashboard-token` в `tools/k8s-kind-setup/` с ASCII баннером


## [1.2.4] - 2024-02-13

### Added
- Добавлена поддержка nvidia-smi из WSL2
- Оптимизированы пути монтирования для GPU в WSL2
- Обновлены переменные окружения для NVIDIA
- Улучшена интеграция с NVIDIA Container Toolkit

### Changed
- Обновлен NVIDIA Device Plugin для работы с WSL2
- Модифицирован деплоймент Ollama для корректной работы с GPU
- Добавлены дополнительные тома для NVIDIA capabilities
- Обновлена документация по настройке GPU в WSL2

### Fixed
- Исправлен путь к nvidia-smi в WSL2
- Оптимизирована работа с GPU через Docker
- Улучшена совместимость с NVIDIA Container Runtime

## [1.2.3] - 2024-02-13

### Added
- Добавлена функция автоматической переустановки кластера в deploy-all.sh
- Реализовано последовательное развертывание всех компонентов
- Добавлены проверки готовности для каждого этапа установки
- Улучшена обработка ошибок при развертывании

### Changed
- Оптимизирован процесс развертывания кластера
- Улучшена последовательность установки компонентов
- Добавлены информативные сообщения о процессе установки

## [1.2.2] - 2024-02-13

### Added
- Добавлена автоматическая очистка существующего кластера Kind
- Добавлено ожидание готовности узлов после создания кластера
- Реализована функция пересоздания кластера

### Changed
- Улучшена логика обработки ошибок при создании кластера
- Оптимизирован процесс создания и пересоздания кластера
- Добавлены информативные сообщения о процессе создания

### Fixed
- Исправлена проблема с существующим кластером Kind
- Улучшена обработка ошибок при удалении старого кластера

## [1.2.1] - 2024-02-13

### Added
- Создан скрипт deploy-all.sh для автоматического развертывания всех компонентов
- Добавлена автоматическая настройка GPU для Ollama
- Реализованы проверки успешности каждого этапа установки
- Добавлено автоматическое восстановление после ошибок

### Changed
- Оптимизирована последовательность установки компонентов
- Улучшена обработка ошибок при развертывании
- Добавлены информативные сообщения о процессе установки

## [1.2.0] - 2024-02-13

### Changed
- Обновлена конфигурация Ollama для обязательного использования GPU
- Добавлены nodeSelector и tolerations для GPU-узлов
- Оптимизированы параметры GPU и ресурсные лимиты
- Настроены переменные окружения для оптимальной работы с GPU

### Removed
- Удалена опциональная поддержка CPU для Ollama

## [1.1.9] - 2024-02-13

### Changed
- Оптимизирован скрипт setup-gpu.sh для работы только с узлами Ollama
- Добавлена проверка наличия подов перед настройкой GPU
- Улучшена обработка ошибок в скрипте настройки GPU
- Добавлена дополнительная валидация состояния подов

### Fixed
- Исправлена проблема с установкой меток GPU на все узлы
- Улучшена точность определения узлов для GPU

## [1.1.8] - 2024-02-13

### Added
- Обновлена конфигурация NVIDIA Device Plugin для корректного определения GPU
- Добавлены метки nvidia.com/gpu на узлы кластера
- Улучшен скрипт setup-gpu.sh для автоматической настройки GPU
- Добавлена документация по работе с GPU ресурсами

### Changed
- Оптимизированы настройки NVIDIA Device Plugin
- Улучшена интеграция с Kubernetes для работы с GPU

## [1.1.3] - 2024-02-13

### Added
- Добавлена поддержка GPU для open-webui:
  - Настроена интеграция с NVIDIA GPU
  - Добавлены параметры оптимизации GPU
  - Настроены переменные окружения для CUDA
- Оптимизированы параметры для модели deepseek-r1:14b:
  - Настроен размер контекстного окна
  - Оптимизированы параметры генерации
  - Настроено использование тензорного параллелизма
  - Включена поддержка Flash Attention

### Changed
- Обновлены ресурсы для open-webui под GPU
- Оптимизированы параметры производительности
- Улучшена конфигурация памяти

### Optimized
- Улучшена производительность обработки запросов
- Оптимизировано использование GPU памяти
- Настроены параметры кэширования

## [1.1.2] - 2024-02-13

### Fixed
- Исправлена передача переменных окружения в deployment.yaml для open-webui
- Добавлена корректная обработка env секции из values.yaml
- Улучшена обработка секретов через envFrom

## [1.1.1] - 2024-02-13

### Added
- Добавлены новые функции для улучшения работы с текстом:
  - advanced_grammar_optimizer: продвинутая оптимизация лексики и грамматики
  - deepseek_request_optimizer: оптимизация запросов для deepseek-r1:14b
- Реализована система кэширования для грамматического анализа
- Добавлена оптимизация параллельной обработки запросов
- Настроены специфические параметры для модели deepseek-r1:14b

### Changed
- Оптимизированы настройки производительности open-webui:
  - Улучшено управление памятью
  - Настроена обработка батчей
  - Оптимизировано использование GPU
- Улучшены параметры производительности ollama:
  - Увеличен размер контекстного окна
  - Оптимизирована параллельная обработка
  - Настроено кэширование грамматики

### Optimized
- Улучшена производительность обработки запросов
- Оптимизировано использование памяти
- Ускорена обработка грамматических правил

## [1.0.7] - 2024-02-13

### Added
- Добавлены новые функции для open-webui:
  - context_manager: управление контекстом диалога
  - token_analyzer: анализ использования токенов
  - prompt_optimizer: оптимизация промптов
  - conversation_summarizer: создание саммари диалога
  - semantic_search: семантический поиск
  - style_adapter: адаптация стиля общения
  - format_converter: конвертация форматов
  - template_manager: управление шаблонами
  - error_analyzer: анализ ошибок
  - knowledge_validator: валидация знаний
- Оптимизированы параметры для модели deepseek-r1:14b:
  - Настроен размер контекстного окна
  - Оптимизированы параметры генерации
  - Улучшено управление памятью
  - Настроены лимиты ресурсов

### Changed
- Обновлены ресурсы для open-webui под новую модель
- Оптимизированы параметры производительности
- Улучшена конфигурация инструментов

## [1.0.6] - 2024-02-13

### Added
- Добавлен шаблон промпта на русском языке для Open WebUI
- Созданы инструменты для улучшения работы LLM:
  - search_documentation: поиск в технической документации
  - code_analyzer: анализ и оптимизация кода
  - memory_optimizer: оптимизация использования памяти
- Оптимизированы параметры Open WebUI для снижения потребления памяти

### Changed
- Уменьшены лимиты ресурсов для Open WebUI:
  - CPU: с 1000m до 500m
  - Memory: с 2Gi до 1Gi
- Включены параметры оптимизации памяти:
  - ENABLE_MEMORY_REDUCTION=true
  - COMPUTE_SHAPES=false
  - MAX_PARALLEL_REQUESTS=3

## [1.0.5.a] - 2024-02-13

### Changed
- Оптимизированы ресурсы cert-manager:
  - Основной компонент: 100m CPU, 128Mi RAM
  - Webhook: 50m CPU, 64Mi RAM
  - CAInjector: 50m CPU, 64Mi RAM
- Оптимизированы ресурсы sidecar-injector:
  - Основной контейнер: 25m/50m CPU, 32Mi/64Mi RAM
  - Сайдкары: 25m/50m CPU, 32Mi/64Mi RAM
- Сохранены оригинальные ресурсы для open-webui и ollama

## [1.0.5] - 2024-02-13

### Added
- Добавлена интеграция модели llama2 для связки open-webui + ollama
- Настроены переменные окружения для использования llama2 по умолчанию

### Changed
- Обновлены настройки open-webui для работы с моделью llama2
- Оптимизированы параметры подключения к ollama API

# ... rest of the changelog

## [1.0.4] - 2024-02-13

### Added
- Добавлена кастомная конфигурация CoreDNS для зоны prod.local
- Создан скрипт setup-dns.sh для настройки DNS-резолвинга

### Fixed
- Исправлена проблема с DNS-резолвингом для доменов *.prod.local
- Оптимизирована конфигурация CoreDNS

## [1.3.8] - 2024-02-13

### Added
- Добавлена конфигурация CoreDNS для локального DNS-резолвинга
- Настроено разрешение доменов ollama.prod.local и webui.prod.local

### Fixed
- Исправлена проблема с DNS-резолвингом для локальных доменов
- Улучшена стабильность работы Ingress

## [1.3.7] - 2024-01-20

### Добавлено
- Функция восстановления кластера после перезагрузки
- Автоматическая проверка и перезапуск сервисов
- NodePort доступ к Dashboard через порт 30443
- Улучшенная обработка ошибок и восстановление

### Изменено
- Улучшен процесс установки Dashboard
- Добавлены дополнительные проверки состояния сервисов
- Обновлена документация с инструкциями по восстановлению

## [1.3.6] - 2024-02-10

### Changed
- Обновлена конфигурация для использования существующего cert-manager в namespace prod
- Исправлены доменные имена в конфигурации (webui.local.dev)
- Обновлены пути к сертификатам и секретам
- Удалена установка cert-manager из setup-ingress.sh

### Fixed
- Исправлена проблема с отсутствующими TLS секретами
- Исправлена проблема с namespace для сертификатов
- Исправлена конфигурация Ingress для корректной работы с cert-manager

## [1.3.5] - 2024-02-10

### Changed
- Добавлено автоматическое создание Certificate ресурсов для доменов
- Использование существующего ClusterIssuer для получения сертификатов

## [1.3.4] - 2024-02-09

### Added
- Добавлен скрипт автоматической установки Nginx Ingress Controller (tools/k8s-kind-setup/setup-ingress.sh)
- Добавлена документация по установке и проверке Ingress Controller
- Интегрирована установка Ingress Controller в основной процесс настройки кластера

### Changed
- Обновлен основной скрипт установки для автоматической настройки Ingress Controller
- Расширена документация по устранению проблем с доступом к сервисам

## [1.3.0] - 2024-02-09
### Fixed
- Добавлена проверка готовности TLS секрета перед запуском подов
- Добавлен initContainer для ожидания создания секрета
- Добавлены RBAC правила для доступа к секретам
- Улучшена конфигурация сертификата с правильными хуками Helm
- Добавлена поддержка ServiceAccount для проверки секретов

## [1.2.9] - 2024-02-09
### Fixed
- Исправлена проблема с отсутствующим TLS секретом в sidecar-injector
- Обновлена конфигурация сертификата для корректной генерации TLS секрета
- Добавлены корректные DNS имена для сервисного сертификата

## [1.2.8] - 2024-02-09
### Changed
- Обновлены адреса хостов в конфигурации Ollama
- Изменен домен с example.com на .local
- Обновлена документация с новыми адресами доступа

## [1.2.7] -2024-02-09
### Fixed
- Исправлены конфигурации Ingress для Open WebUI
- Исправлен конфликт портов в Sidecar Injector
- Обновлены настройки портов для избежания конфликтов с nginx-ingress
- Добавлен rewrite-target в аннотации ingress

## [1.2.6] - 2024-02-09
### Added
- Создан Helm чарт для Ollama
- Добавлена интеграция с Open WebUI
- Настроено персистентное хранилище для моделей
- Добавлена поддержка GPU (опционально)
- Реализованы сетевые политики для безопасности
- Добавлены ресурсные лимиты и квоты

## [1.2.4] - 2024-02-09
### Added
- Создан Helm чарт для Open WebUI
- Добавлены шаблоны deployment, service, ingress и pvc
- Настроена интеграция с cert-manager для SSL
- Добавлена поддержка персистентного хранилища
- Реализована конфигурация через values.yaml

## [1.2.3] - 2024-02-09
### Fixed
- Исправлена логика извлечения имени репозитория в deploy-chart.sh
- Добавлена специальная обработка для репозитория jetstack
- Улучшен механизм обработки URL репозиториев Helm

## [1.2.2] - 2024-02-09
### Added
- Добавлен файл _helpers.tpl для sidecar-injector с общими шаблонами Helm
- Добавлены функции для генерации имен и меток
### Fixed
- Исправлена ошибка отсутствия шаблонов в sidecar-injector

## [1.2.1] - 2024-02-09
### Added
- Добавлен файл _helpers.tpl для sidecar-injector с общими шаблонами Helm
- Добавлены функции для генерации имен и меток
### Fixed
- Исправлена ошибка отсутствия шаблонов в sidecar-injector

## [1.2.0] - 2024-02-09
### Added
- Добавлена автоматическая инициализация зависимостей Helm чартов
- Реализована автоматическая сборка зависимостей перед деплоем
- Добавлено автоматическое добавление репозиториев из Chart.yaml
### Fixed
- Исправлены отступы в YAML файлах (приведены к одному пробелу)
- Улучшена обработка зависимостей Helm чартов

## [1.1.9] - 2024-02-09
### Fixed
- Исправлена функция инициализации зависимостей в deploy-chart.sh
- Удалена зависимость от yq для чтения Chart.yaml
- Добавлен более надежный способ чтения зависимостей с помощью grep и awk

### Added
- Добавлена автоматическая инициализация зависимостей Helm чартов
- Реализована автоматическая сборка зависимостей перед деплоем
- Добавлено автоматическое добавление репозиториев из Chart.yaml
### Fixed
- Исправлены отступы в YAML файлах (приведены к одному пробелу)
- Улучшена обработка зависимостей Helm чартов

## [1.1.8] - 2024-02-09
### Fixed
- Исправлена логика поиска и валидации чартов в deploy-chart.sh
- Добавлена подробная диагностика процесса поиска чартов
- Улучшена обработка путей к чартам
- Добавлена проверка наличия Chart.yaml

## [1.1.7] - 2024-02-09
### Fixed
- Исправлена логика работы с чартами в deploy-chart.sh
- Добавлена проверка наличия Chart.yaml перед деплоем
- Улучшена обработка namespace и values файлов
- Исправлена обработка вывода yq
- Добавлена более надежная валидация чартов

## [1.1.6] - 2024-02-09
### Fixed
- Улучшена обработка ошибок в deploy-chart.sh
- Добавлена подробная информация о процессе поиска чартов
- Улучшена обработка values файлов
- Добавлена проверка наличия Chart.yaml
- Улучшена обработка пустых значений из values файлов

## [1.1.5] - 2024-02-09
### Fixed
- Исправлена логика определения пути к директории helm-charts в deploy-chart.sh
- Добавлена более информативная обработка ошибки при отсутствии директории чартов

## [1.1.4] - 2024-02-09
### Fixed
- Исправлен синтаксис команды yq в deploy-chart.sh для корректного чтения install-order.yaml
- Улучшена совместимость с различными версиями yq

## [1.1.3] - 2024-02-09
### Changed
- Обновлен скрипт deploy-chart.sh для поддержки автоматического режима
- Добавлена поддержка переменных окружения в values файлах
- Улучшена обработка ошибок и валидация чартов
- Добавлена поддержка отладочного режима
- Оптимизирована работа с values файлами

## [1.1.2] - 2024-02-09
### Added
- Создан новый инструмент k8s-dashboard-token для получения токена доступа
- Добавлена поддержка различных версий Kubernetes
- Реализована автоматическая проверка компонентов
- Добавлена подробная документация по использованию

## [1.1.1] - 2024-02-09
### Fix
- sidecar-injector values template fixed

## [1.1.0] - 2024-02-09
### Added
- Создан новый инструмент helm-setup для установки Helm
- Добавлен скрипт install-helm.sh для автоматической установки
- Реализовано автоматическое добавление популярных репозиториев
- Добавлена проверка корректности установки
- Создана подробная документация по использованию

## [1.0.9] - 2024-02-09
### Added
- Обновлен helm-deployer для автоматического деплоя всех чартов
- Добавлена поддержка автоматического определения параметров из values.yaml
- Добавлен механизм управления порядком установки чартов
- Добавлена поддержка параметров релиза в values файлах
### Changed
- Упрощен процесс деплоя - теперь не требуются аргументы командной строки
- Улучшена обработка ошибок и вывод информации о процессе установки

## [1.0.8] - 2024-02-09
### Added
- Добавлена поддержка иерархии values файлов в helm-deployer
- Создан глобальный values.yaml для общих настроек чартов
- Реализована автоматическая подгрузка values файлов в порядке приоритета
### Changed
- Обновлена логика работы deploy-chart.sh для поддержки множественных values
- Расширена документация с описанием иерархии values файлов

## [1.0.7] - 2024-02-09
### Added
- Создан универсальный инструмент helm-deployer для деплоя Helm чартов
- Добавлена поддержка различных конфигураций и окружений
- Реализована валидация чартов и автоматическое создание namespace
- Добавлена подробная документация по использованию инструмента

## [1.0.6] - 2024-02-09
### Added
- Добавлены Helm чарты для cert-manager с поддержкой Let's Encrypt
- Создан чарт sidecar-injector для инжекции TLS сайдкаров
- Реализована автоматическая настройка сертификатов для ingress/egress сайдкаров
- Добавлена документация по установке и настройке компонентов

## [1.0.5] - 2024-02-09
### Added
- Создан новый инструмент k8s-kind-setup для установки Kubernetes кластера в WSL2
- Добавлен bash скрипт install-kind-cluster.sh для автоматической установки
- Реализована автоматическая установка и настройка всех компонентов (Docker, kubectl, Kind)
- Добавлена интеграция с Kubernetes Dashboard
- Добавлена подробная документация по установке и использованию